## Requirements

- Handlers infrastructure.
  - `next` (Koa).
  - Register functions to run after.
- Parse request:
  - Path parameters
    - `decodeURIComponent`.
  - Query parameters
    - `URLSearchParams`
    - <https://www.npmjs.com/package/qs>.
  - Cookies.
    - <https://github.com/jshttp/cookie>.
  - `Content-Type`
    - `node:util`’s `MIMEType`
  - Body.
    - Concerns
      - Size limits (HTTP status 413)
    - `application/x-www-form-urlencoded`
      - `URLSearchParams`
      - <https://github.com/expressjs/body-parser>.
    - `multipart/form-data`
      - <https://github.com/mscdex/busboy>.
        - <https://github.com/expressjs/multer>.
        - <https://github.com/richardgirges/express-fileupload>.
      - <https://github.com/node-formidable/formidable>.
        - Does too much (plugins, and so forth).
      - <https://github.com/pillarjs/multiparty>.
        - They recommend using `busboy`.
        - <https://github.com/expressjs/connect-multiparty>.
      - <https://github.com/hapijs/pez>.
        - No documentation.
    - Edge cases
      - Different charsets?
      - `Content-Encoding` (for example, compression)
- Response helpers:
  - Use data returned by handler to control response.
  - Cookies.
    - `encodeURIComponent`
  - Set headers.
  - Redirect.
  - Body.
    - `Content-Type`
      - `node:util`’s `MIMEType`
    - `Content-Length`?
  - Stream.
  - Locals to build response over multiple handlers.
- Route based on several aspects of request.
- Allow multiple handlers to handle the same request.
  - Have functions that run after the response.
- Async handlers.
- Error handlers.
- Terminate responses gracefully.
  - Error in case response isn’t terminated.
- Logging:
  - `X-Forwarded-Host`
- Live updates.
- `listen()`, including graceful termination
- Missing stuff from:
  - Koa
  - Express

## Related Work

- <https://fastify.dev/>
- <https://koajs.com/>
- <https://hono.dev/>
- <https://routup.net/>
- <https://itty.dev/itty-router>
- <https://github.com/lukeed/worktop>
